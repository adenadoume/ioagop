{% load static %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{% block title %}App{% endblock %}</title>
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
  <style>
    body{font-family:ui-sans-serif,system-ui; margin:20px}
    .chip{display:inline-flex; align-items:center; gap:.35rem; padding:.2rem .5rem; background:#eef; border-radius:9999px; margin:.15rem .25rem .15rem 0}
    .chip button{background:transparent; border:0; cursor:pointer}
    .chips{display:flex; flex-wrap:wrap}
    .btn{padding:.4rem .6rem; background:#111827; color:#fff; border-radius:.4rem; text-decoration:none; border:0; cursor:pointer}
    .btn.secondary{background:#6b7280}
    .drop{border:2px dashed #c7c7c7; padding:1rem; border-radius:.5rem; text-align:center}
    .hidden{display:none}
    .fixed{position:fixed}
    .inset-0{top:0;left:0;right:0;bottom:0}
    .z-50{z-index:50}
    .overlay{background:rgba(0,0,0,.75)}
    .modal{max-width:90vw; max-height:90vh; background:#fff; padding:.5rem; border-radius:.5rem; position:relative}
    .close{position:absolute; top:.4rem; right:.6rem; font-size:1.2rem}
  </style>
</head>
<body x-data="lightbox()">
  {% block content %}{% endblock %}

  <!-- Global Alpine Lightbox -->
  <template x-if="open">
    <div class="fixed inset-0 overlay flex items-center justify-center z-50" @click.self="close()">
      <div class="modal">
        <button class="close" @click="close()">âœ•</button>
        <template x-if="type && type.startsWith('image/')">
          <img :src="src" style="max-height:80vh; max-width:80vw; display:block; margin:0 auto"/>
        </template>
        <template x-if="type==='application/pdf'">
          <iframe :src="src" style="width:80vw;height:80vh;border:0"></iframe>
        </template>
        <template x-if="!type || (!type.startsWith('image/') && type!=='application/pdf')">
          <p style="padding:1rem; text-align:center"><a :href="src" target="_blank">Download file</a></p>
        </template>
      </div>
    </div>
  </template>

  <script>
    function lightbox(){
      return {
        open:false, src:'', type:'',
        show(url, ctype){ this.src=url; this.type=ctype||''; this.open=true; },
        close(){ this.open=false; this.src=''; this.type=''; }
      }
    }
  </script>
</body>
</html>
